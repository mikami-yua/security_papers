两种常见的技术：
1.使用中间人方法
	弊端：允许弃用密码套件，一个异构型的网络需要很多经验丰富的管理员管理
2.key的共享和委托
	介绍：企业方向证书或者私钥。客户端共享会话密钥。
以上这两种技术，都违背了端到端加密的初衷，并且实现困难。在多个MB的方法中，对于正则表达式的检测都需要解密数据包。MB需要得到完全的信任

-------------------------------------------------------------------------
本文主要讨论一些加密方案，并研究它们在真实世界的使用部署

将这些归类为4种基本技术，中间人方式作为第5个类别

定义一个通用的框架，标记它们的使用情况和限制。定义三个系统模型用于描述通过MB的流量（面向客户，面向服务器，客户和服务器的）。提供了一种个细化的标准。
定义了信任模型，确认威胁和安全需要
将隐私保护分为两类（主动和被动的）并进行对比
	被动的无需解密或改变底层协议
	主动的需要解密或者修改底层协议（例如：访问控制，可搜索加密，机器学习和可信任硬件）
分析了现有的方法，使作者更了解以后产业化的需求

解密流量是最好的办法，但是什么样的流量需要被解密，这是需要进一步研究的问题

-------------------------------------------------------------------------
实验模型和用例
blindbox blindIdS   Bhargavan
图123 展示了高级的框架内。
MB被设置在client和service端之间时反应最位迅速。

第二部分提到的框架这里有详细的分析
	面向客户：MB接收多个来自client的通向serv的流量，MB执行检查（广告拦截，防火墙等）。
	面向服务器：例如（web服务器）：加密流量从服务器端点路由到服务器的MB，进行流量审查。ps为企业员工不在公司网络下访问公司的资源。
		与面向客户的不同之处在于连接一般有客户端发起。MB主要用于保护服务器：数据库服务器等

----------------------------------------------------------------------------
信任模型
与以往的论文相同，都认为至少有一个端点时诚实的
当两个端点都是恶意的时候：Goltzsche David Goltzsche, Signe Rüsch, Manuel Nieke, Sébastien Vaucher, Nico Weichbrodt, Valerio Schiavoni, Pierre-Louis Aublin, Paolo Costa, Christof Fetzer, Pascal
Felber, Peter Pietzuch, and Rüudiger Kapitza. 2018. ENDBOX: Scalable Middlebox
Functions Using Client-Side Trusted Execution. In 48th Annual IEEE/IFIP International Conference on Dependable Systems and Networks, DSN 2018, Luxembourg,
June 25-28, 2018. IEEE Computer Society, 1–12 ENDBOX试图解决这个问题

本文的假设：一个实体可以是诚实的半诚实的或者不诚实的
表1有list（共同之处：MB都是诚实或半诚实的）只有endbox考虑了两端都不是诚实的情况

SafeBrick [46], ShieldBox [56] and SGX-Box [31].被部署在云端，可能是恶意的

主流假设1：MB不是恶意的，以合端点必须是诚实的
主流假设2：云端的MB是恶意的。或者两端是恶意的MB是诚实的

安全要求：对加密流量进行检测

------------------------------------------------------------------------------
技术
被动的无需解密或改变底层协议
主动的需要解密或者修改底层协议（例如：访问控制，可搜索加密，机器学习和可信任硬件）
	部分检测：基于可搜索加密的技术仅仅在精确匹配和正则表达式匹配上解密
	全面检测：检测所有的payload

中间人可以解密流量进行主动检测	

中间人检测的
	优点：可以不改变底层的tls结构
	功能性：流量可以被解密，也可以对流量再加密（可以处理加密和不加密的两种流量）
	性能：根据一些公司的调查，setup工作需要一定的网络流量和计算开销
	局限：安全性问题，对于外包到云的MB不能得到完全的信任。

可搜素加密
	不解密底层流量进行token匹配的工作
	blindbox使用可搜索加密。主要想法：MB的规则即受用tls的会话密钥进行加密，mb只需要比较client发来的是否一致即可。但是MB不能使用key解密流量
	减轻运算，blindIDS产生了，使用公钥对用于对token的匹配。这也在造成了tls需要被跟换的问题
	spabox：使用的Diffie-Hellman 基于不经意 伪随机 函数 用于 加密 规则 的准备。并且还用到了机器学习
	
【 Xingliang Yuan, Xinyu Wang, Jianxiong Lin, and Cong Wang. 2016. Privacypreserving deep packet inspection in outsourced middleboxes. In 35th Annual
IEEE International Conference on Computer Communications, INFOCOM 2016, San
Francisco, CA, USA, April 10-14, 2016. IEEE, 1–9.】：提出比blindbox更高效的过滤器，扩展了令牌机制，虽然高效但是需要托管。
	privDPI：改进了blindbox的握手机制，减少setup时间，并且使用可以重复使用的中间规则

	优点：TLS不需要被修改，提供了不解密加密流量的检测办法（可疑时依然解密）
	局限性：规则和token的rule的映射。serv、client都需要安装协议。需要独立的信道
	性能：client因为要处理token计算过于密集，mb只执行匹配

访问控制技术：client和service都知道有个MB。并且它们同意赋予MB决定加密流量的访问控制权限。（主要特点是MB可见）
现有的解决方案种，需要对tls等底层协议进行修改才能实现（mcTLS）mbTLS可以做到不修改底层协议
	
	优点：安全性上，提供了一种问责机制，serv端可以对部署的MB进行验证（独一无二）
		性能：不需要SE（可搜索加密）之类的，效率更高。不需要客户端安装整数，不需要MB解密任何流量
		功能：全面
		局限性：tls协议需要改变，安全上MB如果被托管可能会泄露隐私


机器学习
	机器学习可以不改变当前setup的情况下进行检测。主要思路是分析协议的报头，从加密载荷中提取信息
	
	优点：不需要改变tls，从而保证了协议设计之初的安全性
	局限性：功能性，针对不同的情况需要改造迎合不同类型的中间件，性能上，需要高逼真度的训练，很难获得

可信任硬件
	解密流量不在mb，而在一个可以信任的地方。主要需要把会话密钥安全的运送到可信任硬件

SGXBOX

------------------------------------------------------------------------------------------------------------------
比较
中间人技术依然是最受业界欢迎的技术

当前的主要问题是保护tls的端到端安全，尽量少的泄露信息给MB

安全性上：主要体现在token可能会泄露信息，MB可能会与恶意的client或者serv合谋，ML技术如何获得准确的训练集

性能上：SE方案可以保护隐私，但是缠上的开销巨大（仅仅信道就要求两个）。机器学习的解决方案理想，但是需要进一步的探索

新的方案正在向安全硬件（安全飞地）方面转移



